<?xml version="1.0" encoding="UTF-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2005/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Description>
  </Description>
  <Author>
  </Author>
  <PageHeight>11in</PageHeight>
  <PageWidth>8.5in</PageWidth>
  <Width>7.5in</Width>
  <TopMargin>0mm</TopMargin>
  <LeftMargin>0mm</LeftMargin>
  <RightMargin>0mm</RightMargin>
  <BottomMargin>0mm</BottomMargin>
  <PageHeader>
    <Height>.0in</Height>
    <PrintOnFirstPage>false</PrintOnFirstPage>
    <PrintOnLastPage>false</PrintOnLastPage>
  </PageHeader>
  <Body>
    <Height>510.0pt</Height>
    <ReportItems>
      <Textbox Name="Textbox2">
        <Height>18.02pt</Height>
        <Width>227.38pt</Width>
        <Value>="Водитель: " + First(Fields!driver_name, "RouteList")</Value>
        <ZIndex>1</ZIndex>
        <Left>18.00pt</Left>
        <Top>40.70pt</Top>
        <Style>
          <BorderStyle />
          <BorderColor />
          <BorderWidth />
          <FontSize>12pt</FontSize>
        </Style>
      </Textbox>
      <Textbox Name="Textbox3">
        <Height>16.51pt</Height>
        <Width>255.99pt</Width>
        <Value>="Дата выгрузки:" + Format(First(Fields!date, "RouteList"), "dd/MM/yyyy")</Value>
        <ZIndex>1</ZIndex>
        <Left>278.40pt</Left>
        <Top>39.40pt</Top>
        <Style>
          <BorderStyle />
          <BorderColor />
          <BorderWidth />
          <FontSize>12pt</FontSize>
        </Style>
      </Textbox>
      <Textbox Name="Textbox4">
        <Height>22.55pt</Height>
        <Width>235.61pt</Width>
        <Value>Кладовщик ______________</Value>
        <ZIndex>1</ZIndex>
        <Left>15.9pt</Left>
        <Top>106.6pt</Top>
        <Style>
          <BorderStyle />
          <BorderColor />
          <BorderWidth />
          <FontSize>16pt</FontSize>
        </Style>
      </Textbox>
      <Textbox Name="Textbox5">
        <Height>24.81pt</Height>
        <Width>221.33pt</Width>
        <Value>Водитель ______________</Value>
        <ZIndex>1</ZIndex>
        <Left>272.9pt</Left>
        <Top>106.7pt</Top>
        <Style>
          <BorderStyle />
          <BorderColor />
          <BorderWidth />
          <FontSize>16pt</FontSize>
        </Style>
      </Textbox>
      <Textbox Name="Textbox6">
        <Height>42.83pt</Height>
        <Width>68.50pt</Width>
        <Value>Экземпляр склада</Value>
        <ZIndex>1</ZIndex>
        <Left>545.37pt</Left>
        <Top>0.00pt</Top>
        <Style>
          <BorderStyle>
            <Default>Solid</Default>
            <Left>Solid</Left>
            <Right>Solid</Right>
            <Top>Solid</Top>
            <Bottom>Solid</Bottom>
          </BorderStyle>
          <BorderColor />
          <BorderWidth />
          <FontSize>12pt</FontSize>
          <VerticalAlign>Middle</VerticalAlign>
          <TextAlign>Center</TextAlign>
        </Style>
      </Textbox>
      <Textbox Name="Textbox7">
        <Height>42.83pt</Height>
        <Width>68.50pt</Width>
        <Value>Экземпляр водителя</Value>
        <ZIndex>1</ZIndex>
        <Left>540.5pt</Left>
        <Top>137.5pt</Top>
        <Style>
          <BorderStyle>
            <Default>Solid</Default>
            <Left>Solid</Left>
            <Right>Solid</Right>
            <Top>Solid</Top>
            <Bottom>Solid</Bottom>
          </BorderStyle>
          <BorderColor />
          <BorderWidth />
          <FontSize>12pt</FontSize>
          <VerticalAlign>Middle</VerticalAlign>
          <TextAlign>Center</TextAlign>
        </Style>
      </Textbox>
      <Line Name="Line1">
        <Height>0.07pt</Height>
        <Width>612.71pt</Width>
        <Style>
          <BorderStyle>
            <Default>Dashed</Default>
          </BorderStyle>
          <BorderColor />
          <BorderWidth>
            <Default>2pt</Default>
          </BorderWidth>
        </Style>
        <Left>0.8pt</Left>
        <Top>136.9pt</Top>
      </Line>
      <Textbox Name="Textbox8" xmlns="http://schemas.microsoft.com/sqlserver/reporting/2005/01/reportdefinition">
        <Height>17.97pt</Height>
        <Width>453.25pt</Width>
        <Value>='Выгрузка ' + Iif(Parameters!nomenclature_category = 'water', 'тары', 'оборудования')+ ' по маршрутному листу №' + First(Fields!id, "RouteList") + ' от ' + Format(First(Fields!date, "RouteList"), "dd/MM/yyyy")</Value>
        <ZIndex>1</ZIndex>
        <Left>49.60pt</Left>
        <Top>7.60pt</Top>
        <Style>
          <BorderStyle />
          <BorderColor />
          <BorderWidth />
          <FontSize>16pt</FontSize>
        </Style>
        <CanGrow>true</CanGrow>
      </Textbox>
      <Table Name="Table1">
        <DataSetName>Nomenclature</DataSetName>
        <NoRows>Query returned no rows!</NoRows>
        <Style>
          <BorderStyle>
            <Default>Solid</Default>
          </BorderStyle>
          <BorderColor />
          <BorderWidth />
        </Style>
        <TableColumns>
          <TableColumn>
            <Width>237.1pt</Width>
          </TableColumn>
          <TableColumn>
            <Width>40.4pt</Width>
          </TableColumn>
          <TableColumn>
            <Width>219.7pt</Width>
          </TableColumn>
          <TableColumn>
            <Width>45.7pt</Width>
          </TableColumn>
        </TableColumns>
        <Header>
          <TableRows>
            <TableRow>
              <Height>12 pt</Height>
              <TableCells>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="Textbox1">
                      <Value>Номенклатура</Value>
                      <Style>
                        <TextAlign>Center</TextAlign>
                        <BorderStyle>
                          <Default>Solid</Default>
                        </BorderStyle>
                        <FontWeight>Bold</FontWeight>
                        <BorderColor />
                        <BorderWidth />
                      </Style>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="Textbox9">
                      <Value>Кол-во</Value>
                      <Style>
                        <TextAlign>Center</TextAlign>
                        <BorderStyle>
                          <Default>Solid</Default>
                        </BorderStyle>
                        <FontWeight>Bold</FontWeight>
                        <BorderColor />
                        <BorderWidth />
                      </Style>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="Textbox12">
                      <Value>Номенклатура</Value>
                      <Style xmlns="http://schemas.microsoft.com/sqlserver/reporting/2005/01/reportdefinition">
                        <TextAlign>Center</TextAlign>
                        <BorderStyle>
                          <Default>Solid</Default>
                        </BorderStyle>
                        <FontWeight>Bold</FontWeight>
                        <BorderColor />
                        <BorderWidth />
                      </Style>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="Textbox14">
                      <Value>Кол-во</Value>
                      <Style xmlns="http://schemas.microsoft.com/sqlserver/reporting/2005/01/reportdefinition">
                        <TextAlign>Center</TextAlign>
                        <BorderStyle>
                          <Default>Solid</Default>
                        </BorderStyle>
                        <FontWeight>Bold</FontWeight>
                        <BorderColor />
                        <BorderWidth />
                      </Style>
                    </Textbox>
                  </ReportItems>
                </TableCell>
              </TableCells>
            </TableRow>
          </TableRows>
          <RepeatOnNewPage>true</RepeatOnNewPage>
        </Header>
        <Details>
          <TableRows>
            <TableRow>
              <Height>12 pt</Height>
              <TableCells>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="Textbox10">
                      <Value>=Fields!name1.Value</Value>
                      <CanGrow>true</CanGrow>
                      <Style>
                        <BorderStyle>
                          <Default>Solid</Default>
                        </BorderStyle>
                        <BorderColor />
                        <BorderWidth />
                      </Style>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="Textbox11">
                      <Value>=Fields!count1.Value</Value>
                      <CanGrow>true</CanGrow>
                      <Style>
                        <BorderStyle>
                          <Default>Solid</Default>
                        </BorderStyle>
                        <BorderColor />
                        <BorderWidth />
                        <TextAlign>Center</TextAlign>
                      </Style>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="Textbox13">
                      <Value>=Fields!name2.Value</Value>
                      <Style xmlns="http://schemas.microsoft.com/sqlserver/reporting/2005/01/reportdefinition">
                        <BorderStyle>
                          <Default>Solid</Default>
                        </BorderStyle>
                        <BorderColor />
                        <BorderWidth />
                      </Style>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="Textbox15">
                      <Value>=Fields!count2.Value</Value>
                      <Style xmlns="http://schemas.microsoft.com/sqlserver/reporting/2005/01/reportdefinition">
                        <BorderStyle>
                          <Default>Solid</Default>
                        </BorderStyle>
                        <BorderColor />
                        <BorderWidth />
                        <TextAlign>Center</TextAlign>
                      </Style>
                    </Textbox>
                  </ReportItems>
                </TableCell>
              </TableCells>
            </TableRow>
          </TableRows>
        </Details>
        <Left>36.0pt</Left>
        <Top>57.1pt</Top>
      </Table>
      <Textbox Name="Textbox16" xmlns="http://schemas.microsoft.com/sqlserver/reporting/2005/01/reportdefinition">
        <Height>17.97pt</Height>
        <Width>453.25pt</Width>
        <Value>='Выгрузка ' + Iif(Parameters!nomenclature_category = 'water', 'тары', 'оборудования')+ ' по маршрутному листу №' + First(Fields!id, "RouteList") + ' от ' + Format(First(Fields!date, "RouteList"), "dd/MM/yyyy")</Value>
        <ZIndex>1</ZIndex>
        <Left>43.8pt</Left>
        <Top>160.2pt</Top>
        <Style>
          <BorderStyle />
          <BorderColor />
          <BorderWidth />
          <FontSize>16pt</FontSize>
        </Style>
        <CanGrow>true</CanGrow>
      </Textbox>
      <Textbox Name="Textbox17" xmlns="http://schemas.microsoft.com/sqlserver/reporting/2005/01/reportdefinition">
        <Height>18.02pt</Height>
        <Width>227.38pt</Width>
        <Value>="Водитель: " + First(Fields!driver_name, "RouteList")</Value>
        <ZIndex>1</ZIndex>
        <Left>17.2pt</Left>
        <Top>191.8pt</Top>
        <Style>
          <BorderStyle />
          <BorderColor />
          <BorderWidth />
          <FontSize>12pt</FontSize>
        </Style>
      </Textbox>
      <Textbox Name="Textbox18" xmlns="http://schemas.microsoft.com/sqlserver/reporting/2005/01/reportdefinition">
        <Height>16.51pt</Height>
        <Width>255.99pt</Width>
        <Value>="Дата выгрузки:" + Format(First(Fields!date, "RouteList"), "dd/MM/yyyy")</Value>
        <ZIndex>1</ZIndex>
        <Left>277.6pt</Left>
        <Top>191.3pt</Top>
        <Style>
          <BorderStyle />
          <BorderColor />
          <BorderWidth />
          <FontSize>12pt</FontSize>
        </Style>
      </Textbox>
      <Table Name="Table2">
        <DataSetName>Nomenclature</DataSetName>
        <NoRows>Query returned no rows!</NoRows>
        <Style>
          <BorderStyle>
            <Default>Solid</Default>
          </BorderStyle>
        </Style>
        <TableColumns>
          <TableColumn>
            <Width>235.8pt</Width>
          </TableColumn>
          <TableColumn>
            <Width>41.4pt</Width>
          </TableColumn>
          <TableColumn>
            <Width>219.7pt</Width>
          </TableColumn>
          <TableColumn>
            <Width>44.5pt</Width>
          </TableColumn>
        </TableColumns>
        <Header>
          <TableRows>
            <TableRow>
              <Height>12 pt</Height>
              <TableCells>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="Textbox19">
                      <Value>Номенклатура</Value>
                      <Style>
                        <TextAlign>Center</TextAlign>
                        <BorderStyle>
                          <Default>Solid</Default>
                        </BorderStyle>
                        <FontWeight>Bold</FontWeight>
                        <BorderColor />
                        <BorderWidth />
                      </Style>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="Textbox20">
                      <Value>Кол-во</Value>
                      <Style>
                        <TextAlign>Center</TextAlign>
                        <BorderStyle>
                          <Default>Solid</Default>
                        </BorderStyle>
                        <FontWeight>Bold</FontWeight>
                        <BorderColor />
                        <BorderWidth />
                      </Style>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="Textbox21">
                      <Value>Номенклатура</Value>
                      <Style>
                        <TextAlign>Center</TextAlign>
                        <BorderStyle>
                          <Default>Solid</Default>
                        </BorderStyle>
                        <FontWeight>Bold</FontWeight>
                        <BorderColor />
                        <BorderWidth />
                      </Style>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="Textbox22">
                      <Value>Кол-во</Value>
                      <Style>
                        <TextAlign>Center</TextAlign>
                        <BorderStyle>
                          <Default>Solid</Default>
                        </BorderStyle>
                        <FontWeight>Bold</FontWeight>
                        <BorderColor />
                        <BorderWidth />
                      </Style>
                    </Textbox>
                  </ReportItems>
                </TableCell>
              </TableCells>
            </TableRow>
          </TableRows>
          <RepeatOnNewPage>true</RepeatOnNewPage>
        </Header>
        <Details>
          <TableRows>
            <TableRow>
              <Height>12 pt</Height>
              <TableCells>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="Textbox23">
                      <Value>=Fields!name1.Value</Value>
                      <CanGrow>true</CanGrow>
                      <Style>
                        <BorderStyle>
                          <Default>Solid</Default>
                        </BorderStyle>
                      </Style>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="Textbox24">
                      <Value>=Fields!count1.Value</Value>
                      <CanGrow>true</CanGrow>
                      <Style>
                        <BorderStyle>
                          <Default>Solid</Default>
                        </BorderStyle>
                        <BorderColor />
                        <BorderWidth />
                        <TextAlign>Center</TextAlign>
                      </Style>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="Textbox25">
                      <Value>=Fields!name2.Value</Value>
                      <CanGrow>true</CanGrow>
                      <Style>
                        <BorderStyle>
                          <Default>Solid</Default>
                        </BorderStyle>
                        <BorderColor />
                        <BorderWidth />
                      </Style>
                    </Textbox>
                  </ReportItems>
                </TableCell>
                <TableCell>
                  <ReportItems>
                    <Textbox Name="Textbox26">
                      <Value>=Fields!count2.Value</Value>
                      <CanGrow>true</CanGrow>
                      <Style>
                        <BorderStyle>
                          <Default>Solid</Default>
                        </BorderStyle>
                        <BorderColor />
                        <BorderWidth />
                        <TextAlign>Center</TextAlign>
                      </Style>
                    </Textbox>
                  </ReportItems>
                </TableCell>
              </TableCells>
            </TableRow>
          </TableRows>
        </Details>
        <Left>36.0pt</Left>
        <Top>206.9pt</Top>
      </Table>
      <Textbox Name="Textbox27" xmlns="http://schemas.microsoft.com/sqlserver/reporting/2005/01/reportdefinition">
        <Height>22.55pt</Height>
        <Width>235.61pt</Width>
        <Value>Кладовщик ______________</Value>
        <ZIndex>1</ZIndex>
        <Left>17.6pt</Left>
        <Top>269.2pt</Top>
        <Style>
          <BorderStyle />
          <BorderColor />
          <BorderWidth />
          <FontSize>16pt</FontSize>
        </Style>
      </Textbox>
      <Textbox Name="Textbox28" xmlns="http://schemas.microsoft.com/sqlserver/reporting/2005/01/reportdefinition">
        <Height>24.81pt</Height>
        <Width>221.33pt</Width>
        <Value>Водитель ______________</Value>
        <ZIndex>1</ZIndex>
        <Left>273.1pt</Left>
        <Top>269.3pt</Top>
        <Style>
          <BorderStyle />
          <BorderColor />
          <BorderWidth />
          <FontSize>16pt</FontSize>
        </Style>
      </Textbox>
    </ReportItems>
  </Body>
  <PageFooter>
    <Height>0pt</Height>
    <PrintOnFirstPage>false</PrintOnFirstPage>
    <PrintOnLastPage>false</PrintOnLastPage>
  </PageFooter>
  <DataSets>
    <DataSet Name="RouteList">
      <Query>
        <DataSourceName>DS1</DataSourceName>
        <CommandText>SELECT
    route_lists.id as id,
    date as date,
    CONCAT_WS(" ", employees.last_name, employees.name, employees.patronymic) as driver_name
FROM route_lists
LEFT JOIN employees ON route_lists.driver_id = employees.id
WHERE route_lists.id = @route_list_id;</CommandText>
        <QueryParameters>
          <QueryParameter Name="route_list_id">
            <Value>=Parameters!route_list_id</Value>
          </QueryParameter>
        </QueryParameters>
      </Query>
      <Fields>
        <Field Name="id">
          <DataField>id</DataField>
          <TypeName>System.Int64</TypeName>
        </Field>
        <Field Name="date">
          <DataField>date</DataField>
          <TypeName>System.DateTime</TypeName>
        </Field>
        <Field Name="driver_name">
          <DataField>driver_name</DataField>
          <TypeName>System.String</TypeName>
        </Field>
      </Fields>
    </DataSet>
    <DataSet Name="Nomenclature">
      <Query>
        <DataSourceName>DS1</DataSourceName>
        <CommandText>SELECT 
    realrow,
    GROUP_CONCAT( IF(rank % 2 = 0, nomenclature_name, NULL)) as name1,
    GROUP_CONCAT( IF(rank % 2 = 0, count, NULL)) as count1,
    GROUP_CONCAT( IF(rank % 2 = 1, nomenclature_name, NULL)) as name2,
    GROUP_CONCAT( IF(rank % 2 = 1, count, NULL)) as count2
FROM
    (SELECT 
        @rownum:=@rownum + 1 AS rank,
            (@rownum - @rownum % 2) AS realrow,
            t.*
    FROM
        (SELECT @rownum:=- 1) r, (SELECT 
        SUM(DISTINCT order_items.count) AS count,
            nomenclature.official_name AS nomenclature_name
    FROM
        route_list_addresses rla
    LEFT JOIN order_items ON order_items.order_id = rla.order_id
    LEFT JOIN nomenclature ON nomenclature.id = order_items.nomenclature_id
    WHERE
                   rla.route_list_id = @route_list_id
       AND @nomenclature_category = nomenclature.category
    GROUP BY nomenclature.id) t) AS step2
GROUP BY step2.realrow;</CommandText>
        <QueryParameters>
          <QueryParameter Name="route_list_id">
            <Value>=Parameters!route_list_id</Value>
          </QueryParameter>
          <QueryParameter Name="nomenclature_category">
            <Value>=Parameters!nomenclature_category</Value>
          </QueryParameter>
        </QueryParameters>
      </Query>
      <Fields>
        <Field Name="name1">
          <DataField>name1</DataField>
          <TypeName>System.String</TypeName>
        </Field>
        <Field Name="name2">
          <DataField>name2</DataField>
          <TypeName>System.String</TypeName>
        </Field>
        <Field Name="count1">
          <DataField>count1</DataField>
          <TypeName>System.Int32</TypeName>
        </Field>
        <Field Name="count2">
          <DataField>count2</DataField>
          <TypeName>System.Int32</TypeName>
        </Field>
      </Fields>
    </DataSet>
  </DataSets>
  <DataSources>
    <DataSource Name="DS1">
      <ConnectionProperties>
        <DataProvider>MySQL.NET</DataProvider>
        <ConnectString>database=Vodovoz;user=;password=;port=3306;server=rs.qsolution.ru</ConnectString>
        <IntegratedSecurity>false</IntegratedSecurity>
      </ConnectionProperties>
    </DataSource>
  </DataSources>
  <ReportParameters>
    <ReportParameter Name="route_list_id">
      <DataType>Integer</DataType>
      <Nullable>false</Nullable>
      <AllowBlank>false</AllowBlank>
      <MultiValue>false</MultiValue>
      <Prompt>
      </Prompt>
    </ReportParameter>
    <ReportParameter Name="nomenclature_category">
      <DataType>String</DataType>
      <Nullable>false</Nullable>
      <AllowBlank>false</AllowBlank>
      <MultiValue>false</MultiValue>
      <Prompt />
    </ReportParameter>
  </ReportParameters>
</Report>